<?xml version="1.0" ?>
<robot name="my_bot">

  <link name="base_link">
    <visual>
      <origin xyz="0 0 0.06" rpy="0 0 0"/>
      <geometry>
        <cylinder radius="0.24" length="0.02"/>
      </geometry>
      <material name="hat_black">
        <color rgba="0.08 0.08 0.08 1.0"/>
      </material>
    </visual>

    <visual>
      <origin xyz="0 0 0.14" rpy="0 0 0"/>
      <geometry>
        <cylinder radius="0.16" length="0.16"/>
      </geometry>
      <material name="hat_black"/>
    </visual>

    <visual>
      <origin xyz="0 0 0.10" rpy="0 0 0"/>
      <geometry>
        <box size="0.34 0.02 0.04"/>
      </geometry>
      <material name="hat_band">
        <color rgba="0.2 0.2 0.2 1.0"/>
      </material>
    </visual>

    <collision>
      <origin xyz="0 0 0.14" rpy="0 0 0"/>
      <geometry>
        <cylinder radius="0.16" length="0.18"/>
      </geometry>
    </collision>

    <inertial>
      <origin xyz="0 0 0.14" rpy="0 0 0"/>
      <mass value="12.0"/>
      <inertia ixx="0.18" ixy="0" ixz="0" iyy="0.18" iyz="0" izz="0.12"/>
    </inertial>
  </link>

  <link name="base_footprint"/>
  <joint name="base_joint" type="fixed">
    <parent link="base_link"/>
    <child link="base_footprint"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <!-- FRONT LEFT (driven) -->
  <link name="wheel_fl_link">
    <visual>
      <origin xyz="0 0 0" rpy="1.5707963267948966 0 0"/>
      <geometry>
        <cylinder radius="0.055" length="0.03"/>
      </geometry>
      <material name="wheel_gray">
        <color rgba="0.55 0.55 0.55 1.0"/>
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="1.5707963267948966 0 0"/>
      <geometry>
        <cylinder radius="0.055" length="0.03"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <mass value="0.15"/>
      <inertia ixx="1e-4" ixy="0" ixz="0" iyy="1e-4" iyz="0" izz="1e-4"/>
    </inertial>
  </link>

  <joint name="wheel_fl_joint" type="continuous">
    <parent link="base_link"/>
    <child link="wheel_fl_link"/>
    <origin xyz="0.16 0.16 0.055" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <dynamics damping="0.0" friction="0.0"/>
  </joint>

  <!-- FRONT RIGHT (driven) -->
  <link name="wheel_fr_link">
    <visual>
      <origin xyz="0 0 0" rpy="1.5707963267948966 0 0"/>
      <geometry>
        <cylinder radius="0.055" length="0.03"/>
      </geometry>
      <material name="wheel_gray"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="1.5707963267948966 0 0"/>
      <geometry>
        <cylinder radius="0.055" length="0.03"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <mass value="0.15"/>
      <inertia ixx="1e-4" ixy="0" ixz="0" iyy="1e-4" iyz="0" izz="1e-4"/>
    </inertial>
  </link>

  <joint name="wheel_fr_joint" type="continuous">
    <parent link="base_link"/>
    <child link="wheel_fr_link"/>
    <origin xyz="0.16 -0.16 0.055" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <dynamics damping="0.0" friction="0.0"/>
  </joint>

  <!-- REAR LEFT (free вращение, НЕ driven) -->
  <link name="wheel_rl_link">
    <visual>
      <origin xyz="0 0 0" rpy="1.5707963267948966 0 0"/>
      <geometry>
        <cylinder radius="0.055" length="0.03"/>
      </geometry>
      <material name="wheel_gray"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="1.5707963267948966 0 0"/>
      <geometry>
        <cylinder radius="0.055" length="0.03"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <mass value="0.15"/>
      <inertia ixx="1e-4" ixy="0" ixz="0" iyy="1e-4" iyz="0" izz="1e-4"/>
    </inertial>
  </link>

  <joint name="wheel_rl_joint" type="continuous">
    <parent link="base_link"/>
    <child link="wheel_rl_link"/>
    <origin xyz="-0.16 0.16 0.055" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <dynamics damping="0.02" friction="0.0"/>
  </joint>

  <!-- REAR RIGHT (free вращение, НЕ driven) -->
  <link name="wheel_rr_link">
    <visual>
      <origin xyz="0 0 0" rpy="1.5707963267948966 0 0"/>
      <geometry>
        <cylinder radius="0.055" length="0.03"/>
      </geometry>
      <material name="wheel_gray"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="1.5707963267948966 0 0"/>
      <geometry>
        <cylinder radius="0.055" length="0.03"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <mass value="0.15"/>
      <inertia ixx="1e-4" ixy="0" ixz="0" iyy="1e-4" iyz="0" izz="1e-4"/>
    </inertial>
  </link>

  <joint name="wheel_rr_joint" type="continuous">
    <parent link="base_link"/>
    <child link="wheel_rr_link"/>
    <origin xyz="-0.16 -0.16 0.055" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <dynamics damping="0.02" friction="0.0"/>
  </joint>

  <!-- DiffDrive задаёт движение ТОЛЬКО передними -->
  <gazebo>
    <plugin filename="gz-sim-diff-drive-system" name="gz::sim::systems::DiffDrive">
      <left_joint>wheel_fl_joint</left_joint>
      <right_joint>wheel_fr_joint</right_joint>

      <wheel_separation>0.32</wheel_separation>
      <wheel_radius>0.055</wheel_radius>

      <topic>/cmd_vel</topic>
      <odom_topic>/odom</odom_topic>
      <tf_topic>/tf</tf_topic>
      <frame_id>odom</frame_id>
      <child_frame_id>base_link</child_frame_id>
      <odom_publish_frequency>50</odom_publish_frequency>

      <max_angular_velocity>6.0</max_angular_velocity>
      <max_angular_acceleration>35.0</max_angular_acceleration>
      <max_linear_velocity>1.5</max_linear_velocity>
      <max_linear_acceleration>5.0</max_linear_acceleration>
    </plugin>
  </gazebo>

  <!-- Трение: передние держат сцепление, задние почти "кастер" -->
  <gazebo reference="wheel_fl_link">
    <mu1>2.0</mu1>
    <mu2>2.0</mu2>
  </gazebo>

  <gazebo reference="wheel_fr_link">
    <mu1>2.0</mu1>
    <mu2>2.0</mu2>
  </gazebo>

  <gazebo reference="wheel_rl_link">
    <mu1>0.02</mu1>
    <mu2>0.02</mu2>
  </gazebo>

  <gazebo reference="wheel_rr_link">
    <mu1>0.02</mu1>
    <mu2>0.02</mu2>
  </gazebo>

  <gazebo reference="base_link">
    <mu1>0.2</mu1>
    <mu2>0.2</mu2>
  </gazebo>

</robot>
